#ifndef _WDIS_EMITTER_H
#define _WDIS_EMITTER_H

#include <fstream>
#include <sstream>
#include <vector>
#include <string>
#include <iostream>
#include <iterator>
using namespace std;

namespace wdis {
	class Emitter {
	public:
		bool isDebug;
		Emitter(bool debug) {
			isDebug = debug;
			// Preamble
			str << "// Decompiled Web Assembly generated by wdis. Preamble:" << endl
			<< "#include <stdint.h> // For the bit size specific types" << endl
			<< "#include <math.h> // For certian WASM binary operations" << endl
			<< "// Bit size specific types not declared in stdint.h:" << endl
			<< "typedef float float32_t;" << endl
			<< "typedef double float64_t;" << endl
			<< "// End of preamble" << endl << endl;
		}
		stringstream& operator<<(string out) {
			str << out;
			if (isDebug) {
				cout << "Emitting '" << out << "'" << endl;
			}
			return str;
		}
		void comment(string cmt) {
			str << "// " << cmt << endl;
			if (isDebug) {
				cout << "Emitting comment '" << cmt << "'" << endl;
			}
		}
		void ln() {
			str << endl;
			if (isDebug) {
				cout << "Emmitting newline" << endl;
			}
		}
		string getCode() {
			return str.str();
		}
	protected:
		stringstream str;
	};
} // namespace wdis

#endif // _WDIS_EMITTER_H